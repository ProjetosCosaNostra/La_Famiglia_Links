<!DOCTYPE html>
<html lang="pt-BR">
>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>üé© Business View ‚Äî La Famiglia Links</title>

  <!-- Chart.js para os gr√°ficos -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    :root {
      --gold: #d4af37;
      --gold2: #b08d2f;
      --dark: #000;
      --smoke: rgba(255,255,255,.05);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      background: var(--dark);
      color: var(--gold);
      font-family: "Cinzel", serif;
      overflow-x: hidden;
    }
    header {
      text-align: center;
      border-bottom: 1px solid var(--gold2);
      padding: 18px;
      position: sticky;
      top: 0;
      background: rgba(0,0,0,.95);
      backdrop-filter: blur(6px);
      z-index: 10;
    }
    h1 { margin: 0; font-size: 26px; }
    .subtitle { margin: 5px 0 0; opacity: .8; font-style: italic; }
    main { max-width: 1300px; margin: 0 auto; padding: 24px; }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .card {
      background: var(--smoke);
      border: 1px solid var(--gold2);
      border-radius: 14px;
      padding: 22px;
      text-align: center;
      box-shadow: 0 0 22px rgba(212,175,55,.15);
      transition: .3s;
    }
    .card:hover { transform: scale(1.02); box-shadow: 0 0 25px rgba(212,175,55,.3); }

    .big { font-size: 42px; margin: 8px 0; }
    .small { font-size: 14px; opacity: .85; }

    .charts { margin-top: 40px; }
    canvas { width: 100% !important; height: 300px !important; }

    .footer {
      margin: 40px 0 10px;
      text-align: center;
      opacity: .8;
      font-size: 13px;
    }

    .btn {
      display:inline-block;
      border:1px solid var(--gold);
      color:var(--gold);
      padding:8px 14px;
      border-radius:8px;
      text-decoration:none;
      font-weight:600;
      transition:.2s;
      margin:4px;
    }
    .btn:hover { background:var(--gold); color:#000; }
    .badge {
      border: 1px solid var(--gold2);
      border-radius: 999px;
      font-size: 12px;
      padding: 3px 8px;
      margin-left: 6px;
    }
  </style>
</head>

<body>
  <header>
    <h1>üé© Business View ‚Äî La Famiglia Links</h1>
    <p class="subtitle">‚ÄúFam√≠lia, honra, respeito e palavra. No fim, √© s√≥ isso que fica.‚Äù</p>
  </header>

  <main>
    <!-- Indicadores principais -->
    <div class="grid">
      <div class="card">
        <h2>üìà Afiliados</h2>
        <div class="big" id="countAfiliados">0</div>
        <div class="small">Produtos cadastrados</div>
      </div>
      <div class="card">
        <h2>üé¨ M√≠dias Criadas</h2>
        <div class="big" id="countMidias">0</div>
        <div class="small">Banners + V√≠deos</div>
      </div>
      <div class="card">
        <h2>ü§ñ Postagens Autom√°ticas</h2>
        <div class="big" id="countPostagens">0</div>
        <div class="small">Enviadas com sucesso</div>
      </div>
      <div class="card">
        <h2>üß≠ Tend√™ncias Monitoradas</h2>
        <div class="big" id="countTendencias">0</div>
        <div class="small">Itens analisados hoje</div>
      </div>
    </div>

    <!-- Gr√°ficos -->
    <div class="charts">
      <h2 style="text-align:center;">üìä Evolu√ß√£o Semanal</h2>
      <canvas id="chart1"></canvas>
    </div>

    <div class="charts">
      <h2 style="text-align:center;">üíº Distribui√ß√£o de M√≠dias</h2>
      <canvas id="chart2"></canvas>
    </div>

    <!-- Atalhos r√°pidos -->
    <div style="text-align:center;margin-top:40px;">
      <a href="/business/affiliates_intel/" class="btn" target="_blank">üì° Affiliates Intel</a>
      <a href="/business/media/" class="btn" target="_blank">üé¨ Media AI</a>
      <a href="/business/autopost/" class="btn" target="_blank">ü§ñ AutoPost</a>
      <a href="/business/trends/" class="btn" target="_blank">üß≠ Trends</a>
      <a href="/business/payments/" class="btn" target="_blank">üí∞ SaaS Premium</a>
    </div>

    <div class="footer">
      ‚öúÔ∏è ‚ÄúNada √© coincid√™ncia, √© estrat√©gia.‚Äù <br>
      <small>¬© 2025 ‚Äî Cosa Nostra Systems</small>
    </div>
  </main>

  <script>
    // Atualiza os n√∫meros a cada minuto
    async function loadStats() {
      try {
        const res = await fetch('/business/stats');
        const js = await res.json();

        document.getElementById('countAfiliados').innerText = js.afiliados || 0;
        document.getElementById('countMidias').innerText = (js.banners + js.videos) || 0;
        document.getElementById('countPostagens').innerText = js.postagens || 0;
        document.getElementById('countTendencias').innerText = 7; // valor simb√≥lico

        grafico1();
        grafico2();
      } catch (err) {
        console.warn('‚ö†Ô∏è Erro ao carregar estat√≠sticas:', err);
      }
    }

    // Gr√°fico de evolu√ß√£o semanal
    function grafico1() {
      const ctx = document.getElementById('chart1');
      new Chart(ctx, {
        type: 'line',
        data: {
          labels: ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'S√°b', 'Dom'],
          datasets: [{
            label: 'M√≠dias geradas',
            data: [3, 5, 6, 8, 7, 11, 9],
            borderColor: '#d4af37',
            backgroundColor: 'rgba(212,175,55,0.2)',
            tension: 0.3,
            fill: true
          }]
        },
        options: {
          plugins: { legend: { labels: { color: '#d4af37' } } },
          scales: {
            x: { ticks: { color: '#d4af37' }, grid: { color: 'rgba(212,175,55,.15)' } },
            y: { ticks: { color: '#d4af37' }, grid: { color: 'rgba(212,175,55,.1)' } }
          }
        }
      });
    }

    // Gr√°fico de distribui√ß√£o de m√≠dia
    function grafico2() {
      const ctx = document.getElementById('chart2');
      new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: ['Banners', 'V√≠deos', 'Postagens'],
          datasets: [{
            data: [45, 35, 20],
            backgroundColor: ['#d4af37', '#b08d2f', '#7f6c2b'],
            borderWidth: 0
          }]
        },
        options: {
          plugins: { legend: { labels: { color: '#d4af37' } } }
        }
      });
    }

    // Inicializa√ß√£o + atualiza√ß√£o peri√≥dica
    (async function init() {
      await loadStats();
      setInterval(loadStats, 60000);
    })();
  </script>
</body>
</html>
